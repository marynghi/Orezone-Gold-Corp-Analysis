---
title: "Gold"
author: '26041'
date: "2024-11-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(stargazer)
library(readxl)
```

```{r echo=FALSE}
df_fin1 <- read_excel("/Users/ThaoNghi/Documents/finance/Orezone Gold/Comparables/Gold 1 for regression.xls", sheet = 1, na = "-")
df_gold1 <- read_excel("/Users/ThaoNghi/Documents/finance/Orezone Gold/Comparables/Gold 1 for regression.xls", sheet = 8, na = "-")
df_fin2 <- read_excel("/Users/ThaoNghi/Documents/finance/Orezone Gold/Comparables/Gold 2.xls", sheet = 1, na = "-")
df_gold2 <- read_excel("/Users/ThaoNghi/Documents/finance/Orezone Gold/Comparables/Gold 2.xls", sheet = 8, na = "-")
df_fin3 <- read_excel("/Users/ThaoNghi/Documents/finance/Orezone Gold/Comparables/Gold 3.xls", sheet = 1, na = "-")
df_gold3 <- read_excel("/Users/ThaoNghi/Documents/finance/Orezone Gold/Comparables/Gold 3.xls", sheet = 8, na = "-")
```

```{r echo=FALSE}
df_fin <- rbind(df_fin1, df_fin2, df_fin3)
df_gold <- rbind(df_gold1, df_gold2, df_gold3)
merged_left <- merge(df_fin, df_gold, by = "Company Name", all.x = TRUE)
df <- merged_left[!is.na(merged_left$`Total Enterprise Value Latest`),]
df <- df[!is.na(df$`FY P&P Ore Reserves (in '000s of T)`) & !is.na(df$`FY P&P Reserves Grade (g/T)`), ]
df <- df[!is.infinite(df$`FY P&P Ore Reserves (in '000s of T)`) & !is.infinite(df$`FY P&P Reserves Grade (g/T)`), ]
df <- df[!is.na(df$`FY Measured and Indicated Ore Resources (in '000s of T)`) & !is.na(df$`FY Measured and Indicated Resources Grade (g/T)`),]
```

```{r echo=FALSE}
df$`FY P&P Ore Reserves (in '000s of T)` <- as.numeric(gsub(",", "", df$`FY P&P Ore Reserves (in '000s of T)`))
df$`FY P&P Reserves Grade (g/T)` <- as.numeric(gsub(",", "", df$`FY P&P Reserves Grade (g/T)`))
sum(is.na(df$`FY P&P Ore Reserves (in '000s of T)`))
sum(is.na(df$`FY P&P Reserves Grade (g/T)`))
```


```{r echo=FALSE}
df$'PP' <- df$`FY P&P Ore Reserves (in '000s of T)`*1000*df$`FY P&P Reserves Grade (g/T)`*0.035274
df$'MI' <- df$`FY Measured and Indicated Ore Resources (in '000s of T)`*1000*df$`FY Measured and Indicated Resources Grade (g/T)`*0.035274
df$"EV" <- df$`Total Enterprise Value Latest`*1000000
```

```{r}
ggplot(df, aes(x = log(PP))) +
  geom_histogram(bins = 25)
ggplot(df, aes(x = log(MI))) +
  geom_histogram(bins = 25)
ggplot(df, aes(x = log(EV))) +
  geom_histogram(bins = 20)
```

```{r echo=FALSE}
model <- lm(EV ~ PP + MI, data = df)
summary(model)
stargazer(model, type = "text", digits = 4)
```
```{r echo=FALSE}
ggplot(df, aes(x = log(MI), y = log(EV))) +
  geom_point() + geom_smooth(method = "lm", color = "blue")
  labs(title = "Regression Plot: EV ~ PP + MI", x = "MI", y = "EV")
```

